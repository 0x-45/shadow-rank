# PRD: Shadow Rank Feature Updates v2

## 1. Introduction/Overview

This document outlines the next phase of feature development for Shadow Rank, a gamified developer skill-building platform. The focus is on achieving **100% core functionality** before any UI revamp. 

Key areas of improvement include:
- Enhanced Debugging Skill experience with a proper code editor
- Skill Radar Chart visualization derived from resume data
- Resume management with Supabase storage
- AI-powered quest generation using OpenAI (via LangChain)
- Goal-setting feature to personalize the learning journey

## 2. Goals

1. **Functional Debugging Experience**: Provide a real code editing environment with syntax highlighting and console output visibility
2. **Skill Progression System**: Display skills as a radar/spider chart visualization with levels derived from resume + earned XP
3. **Resume Management**: Allow users to upload, store, and update their resume with parsed skills reflected in the app
4. **AI-Driven Personalization**: Generate relevant quests based on user's resume and stated career goal
5. **Goal-Oriented Learning**: Enable users to set a career goal that influences quest generation

## 3. User Stories

### Debugging Skill
- **US-1**: As a user, I want to solve debugging challenges in a proper code editor with syntax highlighting so I can have a realistic coding experience.
- **US-2**: As a user, I want to see console.log outputs when I run my code so I can debug effectively.
- **US-3**: As a user, I want to click a "Complete Solution" button to reveal the answer when I'm stuck (forfeiting XP).
- **US-4**: As a user, I want the debugging interface to be a large slide panel (not a modal) so I have more screen space to work.

### Skill Radar Chart
- **US-5**: As a user, I want to see all my skills displayed as a radar/spider chart so I can visualize my proficiency levels at a glance.
- **US-6**: As a user, I want my initial skill levels to be calculated from my resume so the app reflects my existing expertise.
- **US-7**: As a user, I want to click on a skill axis (if available for leveling) to open the skill practice interface.
- **US-7b**: As a user, I want to click "Level Up Skills" button to open the Skill Radar Chart view.

### Resume Management
- **US-8**: As a user, I want to upload my resume and have it stored securely so I can update it later.
- **US-9**: As a user, I want to see my last uploaded resume in my profile.
- **US-10**: As a user, I want to update my resume, and have my skills recalculated while preserving XP I've earned.

### AI Quest Generation
- **US-11**: As a user, I want my Main Quests to be generated by AI based on my resume so they're relevant to my experience level.
- **US-12**: As a user, I want to set a career goal so that generated quests help me work toward that goal.

### Goal Feature
- **US-13**: As a user, I want to add a free-text career goal (e.g., "Become a senior backend engineer").
- **US-14**: As a user, I want to delete my goal if I change my mind.
- **US-15**: As a user, I want my goal to influence the AI-generated quests I receive.

## 4. Functional Requirements

### 4.1 Debugging Skill Interface

| ID | Requirement |
|----|-------------|
| FR-1 | The system must display a code editor using CodeMirror (or similar library) for debugging challenges |
| FR-2 | The code editor must have syntax highlighting for JavaScript/TypeScript |
| FR-3 | The debugging interface must be a slide-out panel from the right side of the screen |
| FR-4 | The slide panel must occupy 75% of the screen width |
| FR-5 | The system must display console.log outputs in a dedicated console panel below or beside the editor |
| FR-6 | The system must include a "Run Code" button that executes the code and shows output |
| FR-7 | The system must include a "Complete Solution" button that reveals the full solution |
| FR-8 | When "Complete Solution" is clicked, the user earns 0 XP for that challenge |
| FR-9 | The system must include a "Submit" button to check the user's solution for correctness |
| FR-10 | The slide panel must be dismissible (close button or click outside) |

### 4.2 Skill Radar Chart Visualization

| ID | Requirement |
|----|-------------|
| FR-11 | The system must display all skills as a radar/spider chart (hexagonal or polygonal based on skill count) |
| FR-12 | Each axis of the radar chart represents one skill category |
| FR-13 | The filled area on the chart represents the user's proficiency level for each skill (scale 1-10) |
| FR-14 | Skill levels must be initially calculated from the parsed resume |
| FR-15 | Each axis must be labeled with the skill name |
| FR-16 | The chart must show concentric level rings (like the reference image) for visual level reference |
| FR-17 | Skills available for leveling up (currently only Debugging) must be visually distinct (e.g., different color, pulsing effect, or highlighted axis) |
| FR-18 | Clicking on an available skill's axis/label must open the corresponding skill practice slide panel |
| FR-19 | The system must include a "Level Up Skills" button that opens/displays the Skill Radar Chart |
| FR-20 | Hovering over a skill axis should show a tooltip with skill name and exact level value |

### 4.3 Resume Management & Storage

| ID | Requirement |
|----|-------------|
| FR-18 | The system must store uploaded resumes in Supabase Storage bucket |
| FR-19 | Only the most recent resume is stored (previous version is overwritten) |
| FR-20 | The system must display the last uploaded resume in the user's profile section |
| FR-21 | The system must include an "Update Resume" button to upload a new resume |
| FR-22 | When a resume is updated, skills must be recalculated from the new resume |
| FR-23 | XP earned from skill challenges must persist even when resume is updated |
| FR-24 | The final skill level = max(resume_calculated_level, previous_level_with_earned_xp) |

### 4.4 Resume Parsing

| ID | Requirement |
|----|-------------|
| FR-25 | The system must implement resume parsing functionality |
| FR-26 | Until full parsing is implemented, use a fake/placeholder markdown resume for testing |
| FR-27 | Parsed skills must be stored in the database linked to the user profile |
| FR-28 | Skill extraction must identify: skill name, inferred proficiency level (1-10 scale) |

### 4.5 AI Quest Generation (OpenAI + LangChain)

| ID | Requirement |
|----|-------------|
| FR-29 | The system must use LangChain for LLM integration to allow easy model switching |
| FR-30 | The system must use OpenAI as the default LLM provider |
| FR-31 | Main Quests must be generated via AI based on the user's parsed resume |
| FR-32 | Quest generation prompt must include: user's skills, skill levels, and career goal (if set) |
| FR-33 | Generated quests must be relevant to the user's current skill level (not too easy, not too hard) |
| FR-34 | The system must store generated quests in the database |

### 4.6 Goal Feature

| ID | Requirement |
|----|-------------|
| FR-35 | The system must include an "Add Goal" button in the dashboard/profile |
| FR-36 | Goals are free-text input (e.g., "Become a senior backend engineer at a FAANG company") |
| FR-37 | Only one goal is allowed per user at a time |
| FR-38 | The system must display the current goal prominently (if set) |
| FR-39 | The system must include a "Delete Goal" button to remove the current goal |
| FR-40 | When a goal is set, it must be included in the AI prompt for quest generation |
| FR-41 | Goal must be stored in the user's profile in the database |

## 5. Non-Goals (Out of Scope)

| Item | Reason |
|------|--------|
| UI/UX Revamp | Deferred until 100% functionality is achieved |
| Multiple resume versions | Only most recent resume is stored |
| Multiple goals | Single goal per user for simplicity |
| Skills other than Debugging | Only Debugging skill is actively levelable in this phase |
| Resume parsing for PDF/DOCX | Use placeholder markdown resume for now |
| Multiple LLM providers | OpenAI only for now (LangChain enables future switching) |

## 6. Design Considerations

### Slide Panel (Debugging Interface)
- Opens from the right side of the screen
- 75% width of viewport
- Dark overlay on the remaining 25% (dismissible on click)
- Contains:
  - Challenge description (top)
  - CodeMirror editor (middle, ~60% height)
  - Console output panel (bottom, ~25% height)
  - Action buttons: Run Code, Submit, Complete Solution, Close

### Skill Radar Chart
- Use a library like `recharts`, `chart.js`, or `d3.js` for radar chart rendering
- Chart structure (reference: hexagonal skill chart):
  - Polygonal shape based on number of skills (6 skills = hexagon)
  - Each vertex/axis represents a skill category
  - Concentric rings show level gradations (1-10 scale)
  - Filled area shows current proficiency across all skills
- Visual styling:
  - Active skills (can level up): Highlighted axis, different color on the filled area, clickable
  - Inactive skills: Standard color, visible but click shows "Coming soon" message
  - Background rings in gradient (darker center, lighter outer)
  - Filled skill area with semi-transparent fill and solid border
- Interaction:
  - Click on skill axis label → opens skill practice slide panel (if available)
  - Hover on axis → tooltip with "Skill Name: Level X/10"

### Profile Section
- Display current goal (if set) with edit/delete options
- Show last uploaded resume (filename, upload date, preview link)
- "Update Resume" button

## 7. Technical Considerations

### Dependencies to Add
- `@codemirror/lang-javascript` - JavaScript/TypeScript syntax highlighting
- `codemirror` or `@uiw/react-codemirror` - React CodeMirror wrapper
- `langchain` - LLM abstraction layer
- `@langchain/openai` - OpenAI integration for LangChain
- `recharts` or `react-chartjs-2` - Radar chart visualization (evaluate options)

### Database Changes
```sql
-- Add goal column to profiles table
ALTER TABLE profiles ADD COLUMN goal TEXT;

-- Add resume_url column to profiles table  
ALTER TABLE profiles ADD COLUMN resume_url TEXT;
ALTER TABLE profiles ADD COLUMN resume_uploaded_at TIMESTAMP;

-- Modify user_skills to track earned XP separately
ALTER TABLE user_skills ADD COLUMN earned_xp INTEGER DEFAULT 0;
ALTER TABLE user_skills ADD COLUMN base_level INTEGER DEFAULT 1; -- from resume
```

### Supabase Storage
- Create a bucket named `resumes` (private)
- File naming: `{user_id}/resume.{extension}`
- Enable RLS policies for user-only access

### LangChain Setup
```typescript
// Pseudocode structure
import { ChatOpenAI } from "@langchain/openai";
import { PromptTemplate } from "@langchain/core/prompts";

const model = new ChatOpenAI({
  modelName: "gpt-4o-mini", // or gpt-4o for better results
  temperature: 0.7,
});

const questPrompt = PromptTemplate.fromTemplate(`
  Based on the following developer profile, generate relevant quests:
  
  Skills: {skills}
  Skill Levels: {skill_levels}
  Career Goal: {goal}
  
  Generate 3-5 quests that help this developer progress toward their goal.
`);
```

### Code Execution (Console Output)
- Use a sandboxed execution approach (e.g., `eval` with try-catch for simple cases)
- For production: Consider using a sandboxed iframe or Web Worker
- Capture console.log by overriding console methods temporarily

## 8. Success Metrics

| Metric | Target |
|--------|--------|
| Debugging challenges completable | 100% of existing challenges work in new editor |
| Console output visibility | Users can see all console.log outputs |
| Resume upload success rate | 100% successful storage to Supabase |
| AI quest generation | Quests generated within 5 seconds |
| Goal influence on quests | Quests visibly relate to stated goal |
| Skill persistence | XP preserved after resume update |

## 9. Implementation Priority

1. **Phase 1: Code Editor & Slide Panel**
   - Implement CodeMirror integration
   - Create slide panel component
   - Add console output capture
   - Add Complete Solution button

2. **Phase 2: Resume Storage**
   - Set up Supabase storage bucket
   - Implement resume upload/update
   - Display resume in profile
   - Create placeholder markdown resume

3. **Phase 3: Skill Radar Chart**
   - Implement radar/spider chart visualization
   - Connect skills from resume parsing
   - Add interactive skill axes (clickable for Debugging)
   - Add Level Up button integration

4. **Phase 4: AI Integration**
   - Set up LangChain with OpenAI
   - Implement quest generation prompt
   - Integrate goal into prompts

5. **Phase 5: Goal Feature**
   - Add goal CRUD UI
   - Store goal in database
   - Connect goal to quest generation

## 10. Open Questions

1. **Code Execution Security**: How should we sandbox user code execution? Options:
   - Simple eval with try-catch (quick but limited)
   - Web Worker isolation (moderate security)
   - External service like Judge0 (most secure but adds complexity)

2. **Radar Chart Library**: Which library best fits our needs?
   - `recharts` (React-native, good DX, built-in RadarChart component)
   - `react-chartjs-2` (Chart.js wrapper, feature-rich)
   - `d3.js` (most flexible for custom styling, steeper learning curve)

3. **Resume Parsing Depth**: For the placeholder, what skills should the fake resume contain to test the full flow?

4. **Quest Refresh Rate**: How often should users be able to regenerate quests? On-demand? Daily? Weekly?

---

*Document Version: 1.1*  
*Created: January 31, 2026*  
*Last Updated: January 31, 2026*  
*Status: Ready for Implementation*
